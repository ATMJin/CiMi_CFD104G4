<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>神秘星星力量⭐65折起 | Cimi交友論壇</title>
    <link rel="icon" href="assets/images/logo.ico" type="image/x-icon">
    <link rel="stylesheet" href="assets/css/product_ad_page.css">
    <script src="js/vue.js"></script>

</head>

<body>
    @@include('layout/header.html')
    <div id="productApp">
        <div class="content_area">
            @@include('layout/sidebar.html')
            <!-- 好物商城最上面的觸銷廣告裡的內頁文章 -->
            <main class="main_product_ad_page">
                <!-- 文章 -->
                <section class="product_ad_txt">
                    <div class="txt_box">
                        <h1>神秘星星力量⭐65折起</h1>
                        <h2>整體運勢🆙滿 490 折 50</h2>
                        <p>抬頭望著數不清的星星✨，
                            化成一個個神祕🔮的星座，
                            他們...想告訴你什麼呢🤔
                            就用好物來提升整體運勢，從⭐出發吧！

                            用測驗找出專屬於妳的推薦好物！
                            💫2/23-3/2 連假星座運勢💫
                            活動詳情 CIMI 搜尋🔎 連假星座運勢測驗
                        </p>
                    </div>
                    <!-- </div> -->
                </section>
                <!-- 商品 -->
                <section class="all">
                    <div class="all_item_box">
                        <!-- 標題 -->
                        <div class="title">
                            <p>商品</p>
                        </div>
                        <!-- 商品 -->
                        <div class="item_box">
                            <div onclick="myFunction()" class="item ligh_box_jump" v-for="(good, index) in ad_goods"
                                :key="index" @click="getGoodNumber(good.goods_no)">
                                <div class="img_box">
                                    <img v-bind:src="good.goods_pic1">
                                </div>
                                <div class="txt_box">
                                    <p>{{good.goods_name}}</p>
                                    <p>NT.{{good.goods_price}}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>

        <!-- 燈箱--感謝文進大大相助!!!!! -->
        <section class="product_lighbox">
            <main class="product_page" v-for="good in ad_goods" v-if="number==good.goods_no">
                <!-- 商品最上面的標題 -->
                <section class="product_page_title">
                    <!-- 商品名稱 -->
                    <div class="txt_box">
                        <p>{{good.goods_name}}</p>
                    </div>
                    <!-- 叉叉按鈕 -->
                    <div class="img_box cross" @click="displayNone">
                        <img src="assets\images\icon\close.png">
                    </div>

                </section>
                <!-- 追蹤分類 -->
                <section class="product_page_sort_follow">
                    <div class="product_item_box">
                        <!-- 圖片 -->
                        <div class="product_img_box">
                            <img src="assets\images\icon\shop_food.png">
                        </div>
                        <!-- 文字 -->
                        <div class="txt_box">
                            <!-- 分類 -->
                            <p style="color:rgb(20, 20, 20);">{{good.goods_class}}</p>
                        </div>
                    </div>
                    <!-- 按鈕 -->
                    <button class="btn-secondary">追蹤</button>
                </section>

                <!-- // 商品照(小圖變大圖 -->
                <section class="product_page_pic">
                    <div class="product_large">
                        <!-- 找大圖圖片1 -->
                        <img id="large" :src="good.goods_pic1">
                    </div>
                    <div class="product_small">
                        <!-- 找圖片1 -->
                        <div class="img_box">
                            <img :src="good.goods_pic1" @click="showLarge" />
                        </div>
                        <!-- 找圖片2 -->
                        <div class="img_box">
                            <img :src="good.goods_pic2" @click="showLarge" />
                        </div>
                        <!-- 找圖片3 -->
                        <div class="img_box">
                            <img :src="good.goods_pic3" @click="showLarge" />
                        </div>
                    </div>
                </section>

                <!-- 商品價格/資訊 -->
                <section class="product_page_price_in">
                    <!-- 文字區 -->
                    <div class="txt_box">
                        <!-- 價格 -->
                        <div class="txt_box_pri">
                            <!-- $價格沒別的 -->
                            <p>NT.{{good.goods_price}}</p>
                        </div>
                        <!-- 愛心 -->
                        <div class="like_box">
                            <div class="img_box">
                                <img src="assets\images\icon\like.png">
                            </div>
                            <!-- 愛心數 -->
                            <div class="num_box">
                                <span class="num product_num">
                                    {{good.goods_like}}
                                </span>
                            </div>
                        </div>
                    </div>
                    <!-- 商品資訊 -->
                    <div class="txt_box_in">
                        <p>
                            {{good.goods_i}}
                        </p>
                    </div>
                </section>

                <!-- 留言區 -->
                <section class="product_comment">
                    <p>共5則留言</p>
                    <!-- 單則留言 -->
                    <div class="comment_box">
                        <div class="comment_head_photo">
                            <img src="https://fakeimg.pl/40x40/200">
                        </div>
                        <div class="comment_txt">
                            <div class="comment_mem_name_box">
                                <span class="comment_mem_name_item">乙骨優太</span>
                                <div class="comment_impeach_icon">
                                    <img src="assets/images/icon/more_hov.png" alt="">
                                </div>
                            </div>
                            <div class="comment_content">
                                這種很脆很好吃欸🤩
                            </div>
                            <div class="comment_info">
                                <div class="comment_like_box">
                                    <div class="comment_like_icon">
                                        <img src="assets/images/icon/like_hov.png" alt="">
                                    </div>
                                    <span class="comment_like_amount">23</span>
                                </div>
                                <span class="comment_date">2022/2/23</span>
                            </div>
                        </div>
                    </div>
                    <!-- 單則留言 -->
                    <div class="comment_box">
                        <div class="comment_head_photo">
                            <img src="https://fakeimg.pl/40x40/200">
                        </div>
                        <div class="comment_txt">
                            <div class="comment_mem_name_box">
                                <span class="comment_mem_name_item">里香超香</span>
                                <div class="comment_impeach_icon">
                                    <img src="assets/images/icon/more_hov.png" alt="">
                                </div>
                            </div>
                            <div class="comment_content">
                                這個超級好吃 之前有吃過！ 超級香然後有微微的甜
                            </div>
                            <div class="comment_info">
                                <div class="comment_like_box">
                                    <div class="comment_like_icon">
                                        <img src="assets/images/icon/like_hov.png" alt="">
                                    </div>
                                    <span class="comment_like_amount">23</span>
                                </div>
                                <span class="comment_date">2022/2/23</span>
                            </div>
                        </div>
                    </div>
                    <!-- 單則留言 -->
                    <div class="comment_box">
                        <div class="comment_head_photo">
                            <img src="https://fakeimg.pl/40x40/200">
                        </div>
                        <div class="comment_txt">
                            <div class="comment_mem_name_box">
                                <span class="comment_mem_name_item">五條悟</span>
                                <div class="comment_impeach_icon">
                                    <img src="assets/images/icon/more_hov.png" alt="">
                                </div>
                            </div>
                            <div class="comment_content">
                                也太便宜了吧！
                            </div>
                            <div class="comment_info">
                                <div class="comment_like_box">
                                    <div class="comment_like_icon">
                                        <img src="assets/images/icon/like_hov.png" alt="">
                                    </div>
                                    <span class="comment_like_amount">23</span>
                                </div>
                                <span class="comment_date">2022/2/23</span>
                            </div>
                        </div>
                    </div>
                    <!-- 單則留言 -->
                    <div class="comment_box">
                        <div class="comment_head_photo">
                            <img src="https://fakeimg.pl/40x40/200">
                        </div>
                        <div class="comment_txt">
                            <div class="comment_mem_name_box">
                                <span class="comment_mem_name_item">純愛戰神</span>
                                <div class="comment_impeach_icon">
                                    <img src="assets/images/icon/more_hov.png" alt="">
                                </div>
                            </div>
                            <div class="comment_content">
                                卡一個!!!!
                            </div>
                            <div class="comment_info">
                                <div class="comment_like_box">
                                    <div class="comment_like_icon">
                                        <img src="assets/images/icon/like_hov.png" alt="">
                                    </div>
                                    <span class="comment_like_amount">23</span>
                                </div>
                                <span class="comment_date">2022/2/23</span>
                            </div>
                        </div>
                    </div>
                    <!-- 單則留言 -->
                    <div class="comment_box">
                        <div class="comment_head_photo">
                            <img src="https://fakeimg.pl/40x40/200">
                        </div>
                        <div class="comment_txt">
                            <div class="comment_mem_name_box">
                                <span class="comment_mem_name_item">咒術迴戰</span>
                                <div class="comment_impeach_icon">
                                    <img src="assets/images/icon/more_hov.png" alt="">
                                </div>
                            </div>
                            <div class="comment_content">
                                卡一個!!!
                            </div>
                            <div class="comment_info">
                                <div class="comment_like_box">
                                    <div class="comment_like_icon">
                                        <img src="assets/images/icon/like_hov.png" alt="">
                                    </div>
                                    <span class="comment_like_amount">23</span>
                                </div>
                                <span class="comment_date">2022/2/23</span>
                            </div>
                        </div>
                    </div>

                </section>

                <!-- 我的留言輸入區 -->
                <section class="product_page_msg">
                    <!-- 右邊 -->
                    <div class="item_box_msger">
                        <!-- 留言頭貼 -->
                        <div class="img_box">
                            <img src="assets\images\icon\nav_member.png">
                        </div>
                        <!-- 留言 -->

                        <div class="txt_box">
                            <input type="text" name="tname" placeholder="留言...">
                        </div>
                    </div>
                    <!-- 左邊icon -->
                    <div class="item_box_fuction_icon">
                        <div class="img_box">
                            <!-- 收藏 -->
                            <div class="img_box_save product_save" title="加入收藏">
                                <img src="assets/images/icon/save_hov.png">
                            </div>

                            <!-- 愛心 -->
                            <div class="img_box_report product_heart" title="加入愛心" @click="initheart(good.goods_no)">
                                <img src="assets\images\icon\like_hov.png">
                            </div>
                        </div>
                        <!-- 立即購買 -->
                        <button class="btn-primary">立即購買</button>

                        <!-- 加入購物車-->
                        <button class="btn-secondary">加入購物車</button>
                    </div>
                </section>
            </main>
        </section>

    </div>

    <!-- 廣告輪播/燈箱/收藏save/愛心heart/js限時特賣(倒數計時)/小圖變大圖 -->
    <script src="js\product_all.js"></script>
    <!-- 撈資料 -->
    <!-- <script src="js\product.js"></script> -->

    <!-- vue product_ad_all -->
    <script>
        new Vue({
            el: "#productApp",
            data: {
                ad_goods: [],
                number: 0,
            },
            methods: {
                //叉叉功能
                displayNone() {
                    let x = document.querySelector(".product_lighbox");
                    x.style.display = "none";
                },
                //燈箱出現的跟圖片顯示要樣
                getGoodNumber(goods_no) {
                    // console.log(this.number);
                    this.number = goods_no;
                    // console.log(this.number);

                },
                getProductAd() {
                    let xhr = new XMLHttpRequest();
                    //打開php的我的php檔
                    xhr.open("get", `phps/product_ad_page.php`, true);
                    xhr.send(null);

                    xhr.onload = () => {
                        // 接收PHP傳來的資料
                        allgoods = JSON.parse(xhr.responseText);
                        // console.log(xhr.responseText);
                        // console.table(allgoods);

                        this.ad_goods = allgoods
                    }
                },
                //小圖變大圖功能
                showLarge(e) {
                    let small = e.target;
                    //大圖路徑變小圖
                    document.querySelector(".large").src = small.src;
                },
                //加入愛心
                initheart(goods_no) {
                    // console.log("ssss")
                    let product_heart = document.querySelector(".product_heart")
                    let product_num = document.querySelector(".product_num")
                    let product_heart_img = document.querySelector(".product_heart img")

                    if (product_heart.title == "加入愛心") {
                        product_heart_img.src =
                            "assets/images/icon/like.png";
                        product_heart.title = "取消愛心";
                        product_num.innerHTML++;

                        let xhr = new XMLHttpRequest();
                        //問號之後傳php資料，因為我們的會員資料寫在local storage,需要的會員資料，在問號後面寫入，商品目前不需要
                        xhr.open("get", `phps/product_heart_num_add.php?goods_no=${goods_no}`, true);
                        xhr.send(null);

                        xhr.onload = function () {
                            // 接收PHP傳來的資料
                            // allgoods = JSON.parse(xhr.responseText);
                            // console.log(xhr.responseText);
                            // console.table(allgoods);
                        }

                    } else {
                        product_heart_img.src =
                            "assets/images/icon/like_hov.png";
                        product_heart.title = "加入愛心";
                        product_num.innerHTML--;

                        let xhr = new XMLHttpRequest();
                        xhr.open("get", `phps/product_heart_num_delete.php?goods_no=${goods_no}`, true);
                        xhr.send(null);

                        xhr.onload = function () {
                            // 接收PHP傳來的資料
                            // allgoods = JSON.parse(xhr.responseText);
                            // console.log(xhr.responseText);
                            // console.table(allgoods);
                        }
                    }

                }


            },
            mounted() {
                this.getProductAd()
            },
            //筆記!!因為愛心第一次沒出現在網頁上所以寫在mounted會抓不到。
            // 用Vue改變網頁，如:v-if
            updated() {

                //----------------------加入收藏 或 取消收藏-------------- 
                let product_save = document.querySelector("product_save");

                function switchFavorite() {
                    if (product_save.title == "加入收藏") {
                        product_save_img.src =
                            "assets/images/icon/save.png";
                        product_save.title = "取消收藏";
                    } else {
                        product_save_img.src =
                            "assets/images/icon/save_hov.png";
                        product_save.title = "加入收藏";
                    }
                }
                //function工具在這這邊
                function initsave() {
                    //設定[加入收藏 或 取消收藏]的點按事件
                    product_save = document.querySelector(".product_save")
                    // 變數名稱
                    product_save_img = document.querySelector(".product_save img")
                    product_save.onclick = switchFavorite;
                } //initsave

                //代表使用這個工具
                initsave()

            },

        })
    </script>


</body>

</html>